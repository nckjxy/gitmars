#!/usr/bin/env node
"use strict";const{program:e}=require("commander"),r=require("shelljs"),{error:s,getCurrent:i}=require("./js/index"),n=require("./js/getConfig")();e.name("gitm permission").usage("[message]").arguments("[message]").description("校验提交权限").option("--no-verify","是否需要跳过校验权限",!1).option("--dev","是否限制dev提交",!1).option("--release","是否限制release提交",!1).action(((e,o)=>{console.log("gitm permission is running");const t=i();let a,g=[n.master],m=r.exec("git show",{silent:!0}).stdout;o.dev&&g.push(n.develop),o.release&&g.push(n.release),a=g.indexOf(t),a>-1&&!o.noVerify&&m&&-1===m.indexOf("Merge:")&&-1===m.indexOf("Merge branch")?(r.echo(s(`${g[a]}分支不允许直接提交`)),r.exit(1)):r.exit(0)})),e.parse(process.argv);
