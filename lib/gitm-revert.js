#!/usr/bin/env node
"use strict";const{program:e}=require("commander"),r=require("shelljs"),{options:i,args:s}=require("./conf/revert"),{error:t,warning:o,queue:a,isGitProject:n}=require("./js/index"),{createArgs:c}=require("./js/tools");n()||(r.echo(t("当前目录不是git项目目录")),r.exit(1)),e.name("gitm revert").usage("[commitid] [-n --number [number]] [-m --mode [mode]]").description("撤销一次提交记录"),s.length>0&&e.arguments(c(s)),i.forEach((r=>{e.option(r.flags,r.description,r.defaultValue)})),e.action(((e,i)=>{let s=[],t="HEAD",n="";if(i.mode&&(n=" -m "+Math.abs(Number(i.mode))),i.number){let e=Math.abs(Number(i.number));e>1&&(t+="~"+(e-1)),s.push({cmd:`git revert ${t}${n}`,config:{slient:!1,again:!0,success:"撤销成功",fail:"出错了，请根据提示处理"}})}else e?s.push({cmd:`git revert ${e}${n}`,config:{slient:!1,again:!0,success:"撤销成功",fail:"出错了，请根据提示处理"}}):(r.echo(o("指令不合法")),r.exit(1));a(s)})),e.parse(process.argv);
