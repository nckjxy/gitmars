#!/usr/bin/env node
"use strict";var e=require("commander"),r=require("shelljs");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("fs"),require("colors");var a=t(r);const o={command:"link",short:null,args:[{required:!1,name:"name",variadic:!1,validator:(e,r,t)=>{/\s+/.test(e)?t(new Error("请不要输入空格")):t()},description:"包的名称"}],options:[]},n=o.args,l=o.options;e.program.name("gitm link").usage("[name]").description("链接本地包"),n.length>0&&e.program.arguments(function(e){let r=[];return e.forEach((e=>{let t=e.name;e.variadic&&(t+="..."),t=e.required?"<"+t+">":"["+t+"]",r.push(t)})),r.join(" ")}(n)),l.forEach((r=>{e.program.option(r.flags,r.description,r.defaultValue)})),e.program.action((e=>{let r=a.default.test("-L",`./node_modules/${e}`),t=a.default.test("-e",`./node_modules/${e}`),o=a.default.which("yarn")?"yarn":"npm";if(e)r?a.default.rm("-rf",`./node_modules/${e}`):t&&a.default.mv(`./node_modules/${e}`,`./node_modules/${e}_bak`);else{const{code:e}=a.default.exec(`${o} link`,{silent:!0});0===e?a.default.echo("处理完成"):a.default.echo("出错了"),a.default.exit(0)}const{code:n}=a.default.exec(`${o} link ${e}`,{silent:!0});0===n?a.default.echo("处理完成"):a.default.echo(`处理失败，${e}软链不存在，请进入本地${e}根目录执行：gitm link`)})),e.program.parse(process.argv);
