"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("shelljs"),{error:t,getGitUser:r}=require("./index"),s=require("./getConfig");exports.getUserToken=function(){const o=s();o.api||(e.echo(t("请配置用于请求权限的api接口地址，接收参数形式：url?name=git_user_name，返回data=token")),process.exit(1));const c=r();c||(e.echo(t("请设置本地git用户名")),process.exit(1));let i,n=e.exec(`curl -s ${o.api}?name=${c}`,{silent:!0}).stdout;try{n=JSON.parse(n),i=n.data||null}catch(e){i=null}return i?i.token||(e.echo(t("请设置access_token")),process.exit(1)):(e.echo(t("没有找到用户，请联系管理员")),process.exit(1)),i};
