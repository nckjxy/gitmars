"use strict";const e=require("shelljs"),t=require("./apollo"),{error:i,success:o,mapTemplate:p}=require("./index");module.exports=async function({env:s,project:a,app:n="all"}){let r,l,c=await t(),u=c[s];return u?(r=u.list.find((e=>e.name===a)),r?n&&r.apps&&!r.apps.includes(n)?(e.echo(i("请输入正确的应用名称")),void e.exit(1)):c.template?(l=p(r.apps&&r.apps.length>0?c.templateWithParam:c.template,{line:u.line,project:r.project,token:u.token,app:n}),e.exec(`curl -u ${c.username}:${c.password} "${l}"`,{silent:!0}),void e.echo(o("成功调起Jenkins构建"))):(e.echo(i("请配置Jenkins构建地址模板")),void e.exit(1)):(e.echo(i("请输入正确的项目名称")),void e.exit(1))):(e.echo(i("请输入正确的环境名称")),void e.exit(1))};
