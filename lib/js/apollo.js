"use strict";"undefined"!=typeof require&&require;const e=require("path"),t=require("node-apollo"),i=require("shelljs"),{error:o,writeFile:r}=require("./index"),n=require("./getConfig");module.exports=function(){return l=this,u=null,s=function*(){const l=e.join(__dirname,"../../cache"),u=(new Date).getTime();let s;if(i.test("-f",l+"/buildConfig.json")&&u-parseInt(i.cat(l+"/buildConfig.txt").stdout)<864e5)return require(l+"/buildConfig.json");const a=n();if(!a.apolloConfig)return i.echo(o("请配置apollo")),void i.exit(0);if("string"==typeof a.apolloConfig)try{s=JSON.parse(a.apolloConfig)}catch(e){return}else s=a.apolloConfig;const f=yield t.remoteConfigService(s);return yield r(l+"/buildConfig.txt",String(u)),yield r(l+"/buildConfig.json",JSON.stringify(f.content)),f.content},new Promise(((e,t)=>{var i=e=>{try{r(s.next(e))}catch(e){t(e)}},o=e=>{try{r(s.throw(e))}catch(e){t(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,o);r((s=s.apply(l,u)).next())}));var l,u,s};
