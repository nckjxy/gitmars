"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("inquirer");require("fs"),require("shelljs");var r=require("colors");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("slash"),require("cosmiconfig");var a=t(e),i=t(r);const o=(e,{options:r,validator:t,transform:a},o)=>{if("checkbox"===o){if(!r.length)return null;let a={type:o,message:"请选择",name:e,choices:[],validate:e=>{if(t){let a=!0;return t(e,r,(e=>{e&&(a=e.message)})),a}return!0}};return r.forEach((e=>{a.choices.push({name:e.description,value:e.long,checked:e.recommend})})),a}if("input"===o){let e=[];return r.forEach((({validator:r,transformer:a,...o})=>{r&&(t=r);let n={type:"input",name:o.name,message:`${o.description||"请输入参数"+o.name+"的值"}${o.required?"":(l="(可不填"+(["",void 0].includes(o.defaultValue)?"":'，默认"'+o.defaultValue+'"')+")",i.default.yellow(l))}`,transformer:(e,r,t)=>a?a instanceof Function?a(e,r,t,o):void 0:e,validate:e=>{let r=!0;return!e&&o.required&&(r="请填写"+o.description),t&&!0===r&&t(e,o,(e=>{e&&(r=e.message)})),r}};var l;""!==o.defaultValue&&(n.defaultValue=o.defaultValue),e.push(n)})),e}};exports.default=async({command:e,args:r,options:t,validatorOpts:i,validatorArgs:n,transformOpts:l,transformArgs:u})=>{let s=[],d=[];if(t.length>0){if(t.some((e=>!e.optional&&!e.required||!e.recommend))){const r=await a.default.prompt(o(e,{options:t,validator:i,transform:l},"checkbox")),{[e]:n}=r;n.forEach((e=>{let r=t.find((r=>r.long===e));r.optional||r.required?d.push({required:r.required,name:r.long,variadic:!1,defaultValue:r.defaultValue,description:r.description}):s.push(e)}))}else d=t.map((e=>({required:e.required,name:e.long,variadic:!1,defaultValue:e.defaultValue,description:e.description})))}if(r.length>0){const t=await a.default.prompt(o(e,{options:r,validator:n,transform:u},"input"));s=[].concat(Object.values(t)).concat(s)}if(d.length>0){const r=await a.default.prompt(o(e,{options:d},"input"));let t=Object.entries(r).map((e=>(""!==e[1]&&(e[1]='"'+e[1]+'"'),e)));s=s.concat(t.flat(1/0))}return Promise.resolve(`${s.join(" ").replace(/\s+/g," ").trim()}`)};
