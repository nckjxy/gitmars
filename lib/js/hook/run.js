"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const{spawnSync:e}=require("child_process"),s=require("../checkGitDirEnv"),o=require("../getConfig")();function t(e,s){return o&&o.hooks&&o.hooks[s]}function n(s,o,t,n){console.info(`gitmars > ${o} (node ${process.version})`);const{status:r}=e("sh",["-c",t],{cwd:s,env:Object.assign(Object.assign({},process.env),n),stdio:"inherit"});if(0!==r){const e=["commit-msg","pre-commit","pre-rebase","pre-push"].includes(o)?"(add --no-verify to bypass)":"(cannot be bypassed with --no-verify due to Git specs)";console.info(`gitmars > ${o} hook failed ${e}`)}return 127===r?1:r||0}function r([,,e="",...s],{cwd:o=process.cwd()}={}){const r=t(0,e),c={};return(null==s?void 0:s.length)&&(c.GITMARS_GIT_PARAMS=s.join(" ")),r?n(o,e,r,c):0}exports.default=async function(){s();try{const e=await r(process.argv);process.exit(e)}catch(e){console.info("Gitmars > 未知错误！请联系吴峰",e),process.exit(1)}},exports.getCommand=t,exports.runCommand=n,exports.start=r;
