#!/usr/bin/env node
"use strict";var e=require("commander"),r=require("shelljs");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("fs"),require("colors");var t=a(r);const n={command:"unlink",short:null,args:[{required:!1,name:"name",variadic:!1,validator:(e,r,a)=>{/\s+/.test(e)?a(new Error("请不要输入空格")):a()},description:"包的名称"}],options:[]},o=n.args,u=n.options;e.program.name("gitm unlink").usage("[name]").description("解除本地包链接"),o.length>0&&e.program.arguments(function(e){let r=[];return e.forEach((e=>{let a=e.name;e.variadic&&(a+="..."),a=e.required?"<"+a+">":"["+a+"]",r.push(a)})),r.join(" ")}(o)),u.forEach((r=>{e.program.option(r.flags,r.description,r.defaultValue)})),e.program.action((e=>{let r=t.default.test("-L",`./node_modules/${e}`),a=t.default.test("-e",`./node_modules/${e}_bak`),n=t.default.which("yarn")?"yarn":"npm";e?r?t.default.exec(`${n} unlink ${e}`,{silent:!0}):t.default.echo("没有找到软链，请确认输入正确名称"):(t.default.exec(`${n} unlink`,{silent:!0}),t.default.echo("处理完成"),t.default.exit(0)),a&&t.default.mv(`./node_modules/${e}_bak`,`./node_modules/${e}`),t.default.echo("处理完成")})),e.program.parse(process.argv);
