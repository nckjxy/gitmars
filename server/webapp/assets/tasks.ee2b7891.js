import{G as a,a7 as t,a8 as s,r as e,A as r,ag as n,p as c,d as i,g as d,o,j as p,i as l,e as m,w as u,F as j,aa as y,q as f,s as h,t as k,k as v,h as g}from"./vendor.1c9db40c.js";import{X as x}from"./index.3d6511a4.js";import{T as b,S as w}from"./index.a9e03624.js";import{u as $}from"./use-current-instance.0142bbc2.js";var _={name:"ControlTasks",components:{Xterm:x},async setup(){const{getTerminal:c}=a(b,{}),{socket:i}=a(w,{}),{globalProperties:{$axios:d}}=$();t();const o=s(),p=e({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1});r((()=>{})),n((()=>{}));const l=a=>{p.terminal&&i.emit(p.terminal.name+"-input",` ${a}\r`)};return p.project=await(async()=>(await d({url:"/common/project/list",data:{id:o.query.id}})).data)(),p.scripts=await(async()=>{const{data:{scripts:a}}=await d({url:"/cmd/fs/read",data:{path:`${p.project.path}/package.json`}});return a})(),await d({url:"/cmd/cd",data:{dir:p.project.path}}),p.terminal=c&&c(p.project.id,p.project.path),p.ready=!0,{data:p,exec:l,run:a=>{l(`yarn run ${a}`)},route:o}}};c("data-v-60f1990d");const C={key:0,class:"page"},T=h(" tasks "),X=h("创建分支"),q={class:"cont"},z={class:"nav"},A={key:0,class:"bugfix"},F=l("dt",null,"脚本指令",-1),G=h("执行"),I={class:"main"},O=l("span",null,[l("i",{class:"iconfont icon-layout"}),h(" 当前分支： ")],-1);i(),_.render=function(a,t,s,e,r,n){const c=d("v3-button"),i=d("Xterm");return e.data.ready?(o(),p("div",C,[l("h1",null,[T,l("p",null,[m(c,{type:"primary"},{default:u((()=>[X])),_:1})])]),l("div",q,[l("div",z,[Object.keys(e.data.scripts).length>0?(o(),p("dl",A,[F,(o(!0),p(j,null,y(e.data.scripts,((a,t)=>(o(),p("dd",{class:f({active:!1}),key:t},[h(k(t)+" ",1),m(c,{type:"primary",size:"mini",onClick:a=>e.run(t),plain:""},{default:u((()=>[G])),_:2},1032,["onClick"])])))),128))])):v("",!0)]),l("div",I,[l("h3",null,[O,l("p",null,k(e.data.project.path),1)]),e.data.project?(o(),g(i,{key:0,ref:"xterm",class:"xterm",id:e.data.project.id,path:e.data.project.path},null,8,["id","path"])):v("",!0)])])])):v("",!0)},_.__scopeId="data-v-60f1990d";export{_ as default};
